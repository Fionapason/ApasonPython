import serial
import time

timeout_time = 1

def readSerial(ser):

    maxLoops = timeout_time*1000
    count = 0

    while (ser.inWaiting() < 1) & (count < maxLoops) :
        time.sleep(0.001)
        count = count+1
    buffer = ser.read().decode('utf-8')
    ser.flush()
    return buffer

if __name__ == '__main__':
    first_port = serial.Serial(port='/dev/tty.usbmodem1401', baudrate=115200, parity=serial.PARITY_NONE,
                                   bytesize=serial.EIGHTBITS, stopbits=serial.STOPBITS_ONE, timeout=timeout_time, xonxoff=False,
                                   rtscts=False,
                                   dsrdtr=False)
    first_port.flush()
    first_port.write(b'a')
    print(readSerial(first_port))
    first_port.write(b'a')
    print(readSerial(first_port))
    first_port.write(b'{')
    print(readSerial(first_port))
    first_port.write(b'=')
    print(readSerial(first_port))
    first_port.write(b'X')
    print(readSerial(first_port))